---
import { blurStyle, type Image } from '@/helpers/images';
import options from '@/options';
import { getEntry } from 'astro:content';

interface Props extends Image {
  alt: string;
}

let { alt, src, width, height, blurDataURL, blurWidth, blurHeight } = Astro.props;
if (src.startsWith('/')) {
  const image = await getEntry('images', src);
  src = image.data.src;
  width = image.data.width;
  height = image.data.height;
  blurDataURL = image.data.blurDataURL;
  blurWidth = image.data.blurWidth;
  blurHeight = image.data.blurHeight;
}
---

<img
  src={options.thumbnail({ src, width, height })}
  {alt}
  loading="lazy"
  {width}
  {height}
  style={blurStyle({ src, width, height, blurDataURL, blurWidth, blurHeight })}
/>
